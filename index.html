<!DOCTYPE html>
<html>
    <head>
        <title>
            NYC MAP APP (CAU) | DRAFT | version created 09/11/15
        </title>
 
        <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
        <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
 
        <link rel="shortcut icon" href="http://cartodb.com/assets/favicon.ico" />
 
      <!--  <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.css" /> -->
        <link rel="stylesheet" href="../nyc-map-app/src/leaflet.groupedlayercontrol.css" />
 

        <link rel="stylesheet" href="http://libs.cartocdn.com/cartodb.js/v3/themes/css/cartodb.css" type="text/css" /> 
 


   <!-- <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script> -->
   <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script> -->

  <style type="text/css">
            html, body, #map {
                height: 100%;
                padding: 0;
                margin: 0;
            }



/* new legend code test ---  source :   http://gis.stackexchange.com/questions/141745/horizontal-legend-leaflet-js?rq=1  */

.legend span, .legend label {
  display: block;
  background: rgba(255,255,255,1);
  width: 40px;
  height: 18px;
  float: left;
  opacity: 1;
  text-align: center;
  font-size: 80%
}

/* legend code test 1 */
    .my-legend {
              position: absolute;
              bottom: 75px;
              right: 10px;
            }
            
    .my-legend {
              background: rgba(255,255,255,0.9);
              border-radius: 5px;
              padding: 2px;
              border: 2px solid #999;
              
              }

  .my-legend .legend-title {
    text-align: left;
    margin-bottom: 8px;
    font-weight: bold;
    font-size: 80%;
    }
  .my-legend .legend-scale ul {
    margin: 0;
    padding: 0;
    float: left;
    list-style: none;
    }
  .my-legend .legend-scale ul li {
    display: block;
    float: left;
    width: 35px;
    margin-bottom: 6px;
    text-align: center;
    font-size: 70%;
    list-style: none;
    }
  .my-legend ul.legend-labels li span {
    display: block;
    float: right;
    height: 20px;  /* height & width of the blocks in pixels */
    width: 35px;
    }
  .my-legend .legend-source {
    font-size: 70%;
    color: #999;
    clear: both;
    }
  .my-legend a {
    color: #777;
    } 



/* leaflet style overrides */

    .leaflet-control-scale {
      position: absolute;
      bottom: 25px;
      left: 10px;
    }

    .leaflet-control-layers-toggle { 
        width:auto;
        background-position:6px 50% ;
        padding:3px;
        padding-left:36px;
        text-decoration:none;
        line-height:36px;
    }

    .leaflet-right .leaflet-control {
      float: right;
      }
    .leaflet-top .leaflet-control {
      margin-top: 5px;
      }
    .leaflet-bottom .leaflet-control {
      margin-bottom: 5px;
      }
    .leaflet-left .leaflet-control {
      margin-left: 10px;
      }
    .leaflet-right .leaflet-control {
      margin-right: 10px;
      }

    .leaflet-control-layers-expanded {
          background: none repeat scroll 0 0 rgba(246, 249, 254, 0.95);
          border-radius: 5px;
          box-shadow: 0 0 10px rgba(0, 0, 0, 0.95);
          font: 14px/1.5 "Helvetica Neue", Arial, Helvetica, sans-serif;
          font-weight: 500;
          padding: 10px 16px 6px 5px;   /* top, right, bottom, left */
          height: 500px;
         /* width: 175px; */
          overflow-y: scroll;   
        }

     .my-layer-item-bold {      /* black layer item */
           font: 14px/1.5 "Helvetica Neue", Arial, Helvetica, sans-serif;
           color: #000000;
           font-weight: 800;
    }
     .my-layer-item-basemap {      /* grey bold layer item */
           font: 14px/1.5 "Helvetica Neue", Arial, Helvetica, sans-serif;
           color: #818181;
           font-weight: 800;
    }

     .my-layer-item-italic {      /* italic */
           font: 14px/1.5 "Helvetica Neue", Arial, Helvetica, sans-serif;
           font-style: italic;
           color: #74a9cf;
    }

     .my-layer-item-red {      /* red layer item */
           font: 14px/1.5 "Helvetica Neue", Arial, Helvetica, sans-serif;
           color: #800000; font-weight: 500;
    }

     .my-layer-item-steelblue {     
           font: 14px/1.5 "Helvetica Neue", Arial, Helvetica, sans-serif;
           color: #4682B4; font-weight: 500;
    }

     .my-layer-item-blue {      /* blue layer item */
           font: 14px/1.5 "Helvetica Neue", Arial, Helvetica, sans-serif;
           color: #0000cc; font-weight: 500;
    }
     .my-layer-item-purple {     
           font: 14px/1.5 "Helvetica Neue", Arial, Helvetica, sans-serif;
           color: #800080; font-weight: 500;
    }

     .my-layer-item-salmon {    
           font: 14px/1.5 "Helvetica Neue", Arial, Helvetica, sans-serif;
           color: #CD5C5C;  font-weight: 500;
    }
     .my-layer-item-orange {    
           font: 14px/1.5 "Helvetica Neue", Arial, Helvetica, sans-serif;
           color: #FFA500; font-weight: 500;
    }
     .my-layer-item-yellow {    
           font: 14px/1.5 "Helvetica Neue", Arial, Helvetica, sans-serif;
           color: #DAA520;  font-weight: 500;
    }

     .my-layer-item-green {     
           font: 14px/1.5 "Helvetica Neue", Arial, Helvetica, sans-serif;
           color: #497B49; font-weight: 500;
    }

/*
.instructions {
        position: absolute;
        top: 10px;
        left: 50px;
        background: none repeat scroll 0 0 rgba(255, 255, 255, 0.8);
        border-radius: 5px;
        box-shadow: 0 0 8px rgba(0, 0, 0, 0.9);
        font: 13px/1.4 "Helvetica Neue", Arial, Helvetica, sans-serif;
        padding: 1px 12px 4px 4px;   /* top, right, bottom, left 
        height: 80px;
        width: 230px;
        overflow: auto;    /* allows scrolling in selector 
    }

      .instruct_title {
        font: 18px/1.8 "Helvetica Neue", Arial, Helvetica, sans-serif;
        color: #000;
        font-weight: 900;
        padding: 0 12px 1px 4px;
       }

      .instruct_text {
        font: 13px/1.4 "Helvetica Neue", Arial, Helvetica, sans-serif;
        color: #000;
        padding: 5px 1px 4px 4px;
       } */

/* change the appearance of the leaflet zoom control, copied from http://wcfcourier.com/app/special/fatalcrashes/css/styles.css */
      .leaflet-control-zoom a {
          background-color: #333;
          color: #FFF;  /*black*/
          text-decoration: none;
      }

      .leaflet-bar a:hover {
          background-color: #000;
      }

      .leaflet-control-zoom a:hover {
          background-color: #000;
          color: #CCC;
          text-decoration: none;
      }

      .leaflet-control-zoom a.leaflet-disabled {
          background-color: #999;
        color: #BBB;
      }

      .leaflet-control-zoom a.leaflet-disabled:hover {
          color: #BBB;
      }


      /* "instructions" box */
      #instructions, #hide_show_instructions {
        background-color: #333;
        box-shadow: 0 0 3px rgba(0, 0, 0, 0.9);
        border-radius: 4px;
        left: 45px;
        position: absolute;
        z-index: 20;
        top: 10px;
        color: #FFF;
        font: 14px/1.4 "Helvetica Neue", Arial, Helvetica, sans-serif;
      }
      .title {
        font: 32px/1.4 "Helvetica Neue", Arial, Helvetica, sans-serif;
        font-weight: 700;
        text-align: right;
      }

      .credits {
        text-align: left;
        font: 10px/2.5 "Helvetica Neue", Arial, Helvetica, sans-serif;
        font-weight: 200;
      }

      #instructions {
        width: 25%;
        max-width: 250px;
        max-height: 120px;
        z-index: 7;
        padding: 0 25px 2px 8px;
        border: none;
        overflow: auto;
      }
      #instructions h1 {
        width: 25%;
        text-align: right;
        max-width: 200px;
        z-index: 7;
        padding: 2px 0 0 85px;
        border: none;
      }

      .instructions p {
        margin: 2px;
        text-align: left;
        line-height: 13px;
        padding: 2px 5px 2px 5px;
        clear: both;
      }

      /* Hide, show instructions buttons */
      #hide_show_instructions {
        height: 20px;
        z-index: 8;
        padding: 5px 0 0 6px;
        margin: 0 0 0 0;
                font: 12px "Helvetica Neue", Arial, Helvetica, sans-serif;
                font-weight: 700;
              color: #0080ff;
              border: none;
      }

      .icon-sort-up, .icon-sort-down, .hide_show_instructions_text {
        float: right;
        padding-right: 5px;
        cursor: pointer;
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        -khtml-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
      }

      .icon-sort-up {
        padding-top: 5px;
      }

      .icon-sort-down {
        padding-bottom: 5px;
      }

      </style>
    </head>

    <body>
        <div id="map"></div>

<!--   MAPBOX-style LEGEND  - framwork from SCHLANG map -->
<div class='my-legend'>
<div class='legend-title'>Demographic Layers Legend</div>
<div class='legend-scale'>
  <ul class='legend-labels'>
    <li><span style='background:#FFFFB2;'></span>0-10%</li>
    <li><span style='background:#FED976;'></span>20%</li>
    <li><span style='background:#FEB24C;'></span>35%</li>
    <li><span style='background:#FD8D3C;'></span>50%</li>
    <li><span style='background:#FC4E2A;'></span>65%</li>
    <li><span style='background:#E31A1C;'></span>90%</li>
    <li><span style='background:#B10026;'></span>100%</li>
  </ul>
</div>
<!-- <div class='legend-source'>Source: <a href="#link to source">Name of source</a></div>   -->
</div> 



<!-- code for "instructions" (legend) from  http://wcfcourier.com/app/special/fatalcrashes/ --> 
  <div id="hide_show_instructions">
    <div class="hide_instructions">
      <!-- <div class="icon-sort-up"></div> -->
      <div class="hide_show_instructions_text"> HIDE </div>
    </div>
    <div class="show_instructions" style="display: none;">
      <!-- <div class="icon-sort-down"></div> -->
      <div class="hide_show_instructions_text"> SHOW </div>
    </div>
  </div>

  <div id="instructions" class="box-shadow">
      <p class = "title">Instructions</p> <hr>

      <div id="instructions-text-intro">
        <p class = "instructions">Layers are drawn as you select them, newest on top of oldest. To change the order, simply toggle a layer off and then on again to make it appear on top of others.</p>
        <hr> 
        <p class = "credits"> </p>
      </div>
    </div>

        <!-- include cartodb.js library -->
        <script src="http://libs.cartocdn.com/cartodb.js/v3/3.13/cartodb.js" type="text/javascript"></script> 

  <script src="../nyc-map-app/src/leaflet.groupedlayercontrol.js"></script>
 
        <!--[if lte IE 8]>
        <link rel="stylesheet" href="http://libs.cartocdn.com/cartodb.js/v2/themes/css/cartodb.ie.css" />
        <![endif]-->
 
 <script>
// Toggle for show, hide instructions
// Only visible on desktop
isHideButton = true;
$('#hide_show_instructions').click(function() {
  // console.log(isHideButton);
  if (isHideButton === true) {
    $('.hide_instructions').hide();
    $('.show_instructions').show();
    $('#instructions').slideUp();
    $('#hide_show_instructions').addClass('box-shadow');
    $('.hide_show_instructions').show();
    isHideButton = false;
  } else {
    $('.show_instructions').hide();
    $('.hide_instructions').show();
    $('#instructions').slideDown();
    $('#hide_show_instructions').removeClass('box-shadow');
    $('.hide_show_instructions').show();
    isHideButton = true;
  }
});
</script>

        <script type="text/javascript">
            window.onload = function () {

function getColor(percent_black) {
    return percent_black >= 100 ? '#B10026' :  //100
           percent_black >= 90  ? '#B10026' :  //90-100
                                                // 80-90 ?
           percent_black >= 65  ? '#E31A1C' :  //65-90  (make 65-80)
           percent_black >= 50  ? '#FC4E2A' :  //50-65
           percent_black >= 35   ? '#FD8D3C' :  //35-50
           percent_black >= 20   ? '#FEB24C' :  //20-35
           percent_black >= 10   ? '#FED976' :  //10-20
                      '#FFFFB2';  //0-10
}

function getColor(percent_white) {
    return percent_white >= 100 ? '#B10026' :  //100
           percent_white >= 90  ? '#B10026' :  //90-100
                                                // 80-90 ?
           percent_white >= 65  ? '#E31A1C' :  //65-90  (make 65-80)
           percent_white >= 50  ? '#FC4E2A' :  //50-65
           percent_white >= 35   ? '#FD8D3C' :  //35-50
           percent_white >= 20   ? '#FEB24C' :  //20-35
           percent_white >= 10   ? '#FED976' :  //10-20
                      '#FFFFB2';  //0-10
}

//load up basemaps, store in var objects
var light_nolabels = L.tileLayer('http://{s}.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}.png', {attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'});

var Esri_WorldImagery = L.tileLayer('http://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {attribution: 'Tiles &copy; Esri &mdash; Source: Esri et. al.'});

var OpenStreetMap_Mapnik = L.tileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {maxZoom: 19, attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'});

var Stamen_TerrainBackground = L.tileLayer('http://stamen-tiles-{s}.a.ssl.fastly.net/terrain-background/{z}/{x}/{y}.png', {
  attribution: 'Map tiles by <a href="http://stamen.com">Stamen Design</a>, <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> &mdash; Map data &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>',  subdomains: 'abcd',  minZoom: 4,  maxZoom: 18,  ext: 'png',  bounds: [[22, -132], [70, -56]] });

var black_wallpaper = L.tileLayer('http://www.colourlovers.com/wallPaper/1200x800/n/2875/COLOURlovers.com-Gothic_Wallpaper.png', { attribution: '&copy; <a href="http://www.colourlovers.com/lover/candycrack/loveNote">CandyCrack</a> contributors'});

/*
//create basemaps object 
var baseMaps = {
            "<span class='my-layer-item-basemap'>Gray Basemap</span>": light_nolabels,
            "<span class='my-layer-item-basemap'>Streets</span>": OpenStreetMap_Mapnik,
            "<span class='my-layer-item-basemap'>Satellite Basemap</span>": Esri_WorldImagery,
            "<span class='my-layer-item-basemap'>Shaded Relief</span>": Stamen_TerrainBackground,
            "<span class='my-layer-item-basemap'>Black Wallpaper</span>": black_wallpaper
          };
*/
            // Instantiate new map object, place it in 'map' element
            var map_object = new L.Map('map', {
                center: [40.7033,-73.9796], // New York, NY
                zoom: 11,
                maxZoom: 16,
                minZoom: 10, 
                layers:[light_nolabels]    // initial basemap 
              //scrollWheelZoom: false   // to keep from zooming accidentally
            });

//L.control.layers(baseMaps, null, {collapsed: true, position:'bottomright', autoZIndex: false}).addTo(map_object);

//var legend = L.control({position: 'bottomright'});

// ***********************************************************************
// Leaflet BOUNDARY overlays using cartodb.createLayer and .addTo() method

var labels_overlay = L.tileLayer('http://{s}.basemaps.cartocdn.com/light_only_labels/{z}/{x}/{y}.png', {attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'});
    var l_labels_overlay = new L.LayerGroup();
    labels_overlay.addTo(l_labels_overlay).setZIndex(100);  // high Z - to keep on top of all other layers

var neighborhoods = cartodb.createLayer(map_object, {
                    user_name: 'andrewmartini',
                    type: 'cartodb',
                    sublayers: [{
                      sql: "SELECT * FROM neighborhoods",
                      cartocss: "#layer { polygon-fill: #000000; polygon-opacity: 0; line-color: #000000; line-width: 2; line-opacity: 1;}", 
                      interactivity: "cartodb_id" }]
                    });
    var l_neighborhoods = new L.LayerGroup();
    neighborhoods.addTo(l_neighborhoods);


 var neigh_labels = cartodb.createLayer(map_object, {
                    user_name: 'andrewmartini',
                    type: 'cartodb',
                    sublayers: [{
                      sql: "SELECT * FROM neighborhoods",
                      cartocss: "#layer::labels [zoom >=11]{ polygon-fill: #fff; polygon-opacity: 0; line-width: 0; line-opacity: 0;  text-name: [ntaname3];  text-face-name: 'Lato Bold';  text-size: 9;  text-fill: #333333;  text-opacity: 0.8;  text-halo-fill: #FFF;  text-halo-radius: 0.7;  text-transform: uppercase;  text-wrap-width: 50;  text-wrap-before: true; text-character-spacing: 1.1;  text-allow-overlap:false;  text-placement-type: simple;  text-placements: 'W,E,N,S,8,6';  text-label-position-tolerance:55;  text-min-distance:10; } #layer::labels [zoom >=13]{ polygon-fill: #fff; polygon-opacity: 0; line-width: 0; line-opacity: 0;  text-name: [ntaname3];  text-face-name: 'Lato Bold';  text-size: 12;  text-fill: #333333;  text-opacity: 0.8;  text-halo-fill: #FFF;  text-halo-radius: 1;  text-transform: uppercase;  text-wrap-width: 80;  text-wrap-before: true; text-character-spacing: 1.3;  text-allow-overlap:false;  text-placement-type: simple;  text-placements: 'W,E,N,S,11,10';  text-label-position-tolerance:5;  text-min-distance:10; }",
                      interactivity: "cartodb_id" }]
                    });
    var l_neigh_labels = new L.LayerGroup();
    neigh_labels.addTo(l_neigh_labels);


var nycc = cartodb.createLayer(map_object, {
                    user_name: 'andrewmartini',
                    type: 'cartodb',
                    sublayers: [{
                      sql: "SELECT * FROM nycc",
                      cartocss: "#layer{ polygon-fill: #000000; polygon-opacity: 0; line-color: #000000; line-width: 2; line-opacity: 1; } #nycc::labels [zoom >= 12]{   text-name: 'CC: '+[coundist];   text-face-name: 'Lato Bold Italic';   text-size: 16;   text-label-position-tolerance: 10;  text-character-spacing: 1.3; text-fill: #000;   text-halo-fill: #FFF;   text-halo-radius: 1.5;   text-dy: 0;   text-allow-overlap: false;   text-placement: interior;   text-placement-type: simple;}",
                      interactivity: "cartodb_id"}]
                  });
      var l_nycc = new L.LayerGroup();
      nycc.addTo(l_nycc);  

var nycd = cartodb.createLayer(map_object, {
                    user_name: 'andrewmartini',
                    type: 'cartodb',
                    sublayers: [{
                      sql: "SELECT * FROM nycd_append",
                      cartocss: "#layer { polygon-fill: #000000; polygon-opacity: 0; line-color: #000000; line-width: 2; line-opacity: 1; } #nycd::labels [zoom >= 12]{   text-name: [b_name]+' '+[dist_num];   text-face-name: 'Lato Bold';   text-size: 14;   text-label-position-tolerance: 10;  text-character-spacing: 1.3; text-fill: #000;   text-halo-fill: #FFF;   text-halo-radius: 1.5;   text-dy: 10;   text-allow-overlap: false;   text-placement: interior;   text-placement-type: simple;}",
                      interactivity: "cartodb_id"}]
                  });
      var l_nycd = new L.LayerGroup();
      nycd.addTo(l_nycd); 


var nyss = cartodb.createLayer(map_object, {
                    user_name: 'andrewmartini',
                    type: 'cartodb',
                    sublayers: [{
                      sql: "SELECT * FROM nyss WHERE stsendist is not null",
                      cartocss: "#layer { polygon-fill: #000000; polygon-opacity: 0; line-color: #800080; line-width: 2; line-opacity: 1; } #nyss::labels [zoom >= 12]{   text-name: 'SS: '+[stsendist];   text-face-name: 'Lato Bold';   text-size: 16;   text-label-position-tolerance: 10;  text-character-spacing: 1.3; text-fill: #800080;   text-halo-fill: #FFF;   text-halo-radius: 1.5;   text-dy: 0;   text-allow-overlap: false;   text-placement: interior;   text-placement-type: simple;}",
                      interactivity: "cartodb_id"}]
                  });
      var l_nyss = new L.LayerGroup();
      nyss.addTo(l_nyss); 


var nyad = cartodb.createLayer(map_object, {
                    user_name: 'andrewmartini',
                    type: 'cartodb',
                    sublayers: [{
                      sql: "SELECT * FROM nyad WHERE assemdist is not null",
                      cartocss: "#layer { polygon-fill: #000; polygon-opacity: 0; line-color: #191970; line-width: 2; line-opacity: 1; } #nyad::labels [zoom >= 12]{   text-name: 'AD: '+[assemdist];   text-face-name: 'Lato Bold';   text-size: 16;   text-label-position-tolerance: 10;  text-character-spacing: 1.3; text-fill: #191970;   text-halo-fill: #FFF;   text-halo-radius: 1.5;   text-dy: 0;   text-allow-overlap: false;   text-placement: interior;   text-placement-type: simple;}",
                      interactivity: "cartodb_id"}]
                  });
      var l_nyad = new L.LayerGroup();
      nyad.addTo(l_nyad); 


var nycg = cartodb.createLayer(map_object, {
                    user_name: 'andrewmartini',
                    type: 'cartodb',
                    sublayers: [{
                      sql: "SELECT * FROM nycg WHERE congdist is not null",
                      cartocss: "#layer { polygon-fill: #000; polygon-opacity: 0; line-color: #B22222; line-width: 2; line-opacity: 1; } #nycg::labels [zoom >= 12]{   text-name: 'CG: '+[congdist];   text-face-name: 'Lato Bold';   text-size: 16;   text-label-position-tolerance: 10;  text-character-spacing: 1.3; text-fill: #B22222;   text-halo-fill: #FFF;   text-halo-radius: 1.5;   text-dy: 10;   text-allow-overlap: false;   text-placement: interior;   text-placement-type: simple;}",
                      interactivity: "cartodb_id"}]
                  });
      var l_nycg = new L.LayerGroup();
      nycg.addTo(l_nycg); 


var nybb = cartodb.createLayer(map_object, {
                    user_name: 'andrewmartini',
                    type: 'cartodb',
                    sublayers: [{
                        sql: "SELECT * FROM nybb",
                        cartocss: "#layer { polygon-fill: #FFFFFF;  polygon-opacity: 0;  line-color: #000000;  line-width: 3;  line-opacity: 1; }",
                        interactivity: "cartodb_id"}]
                        });
      var l_nybb = new L.LayerGroup();
      nybb.addTo(l_nybb); 
                          
 var zipcode = cartodb.createLayer(map_object, {
                    user_name: 'andrewmartini',
                    type: 'cartodb',
                    sublayers: [{
                        sql: "SELECT * FROM nyc_zipcode_2014_edit",
                        cartocss: "#layer {   polygon-fill: #FFF;   polygon-opacity: 0;   line-color: #11002F;   line-width: 2;   line-opacity: 1; }  #nyc_zipcode_2014_edit::labels [zoom >12]{   text-name: [postal];   text-face-name: 'Lato Bold';   text-size: 14;   text-label-position-tolerance: 10;   text-fill: #000;   text-halo-fill: #FFF;   text-halo-radius: 1;   text-dy: 0;   text-allow-overlap: false;   text-placement: interior;   text-placement-type: simple; } ",
                        interactivity: "cartodb_id"}]
                        });
      var l_zipcode = new L.LayerGroup();
      zipcode.addTo(l_zipcode);                            

var precincts = cartodb.createLayer(map_object, 'https://ashron24.cartodb.com/api/v2/viz/2fe813da-3d35-11e5-8497-0e0c41326911/viz.json');
      var l_precincts = new L.LayerGroup();
      precincts.addTo(l_precincts); 

var uhf_health = cartodb.createLayer(map_object, {
                    user_name: 'andrewmartini',
                    type: 'cartodb',
                    sublayers: [{
                        sql: "SELECT * FROM chs_2009_dohmh_2010b",
                        cartocss: "#layer  {   polygon-fill: #FFf;   polygon-opacity: 0;   line-color: #000000;   line-width: 2;   line-opacity: 1; }  #chs_2009_dohmh_2010b::labels [zoom > 12] {   text-name: 'UHF: '+ [first_uhf_];   text-face-name: 'Lato Regular';   text-size: 12;   text-label-position-tolerance: 0;   text-fill: #000;   text-halo-fill: #FFF;   text-halo-radius: 1;   text-dy: 0;   text-allow-overlap: true;   text-placement: interior;   text-placement-type: dummy; }",
                        interactivity: "cartodb_id"}]
                      });
      var l_uhf_health = new L.LayerGroup();
      uhf_health.addTo(l_uhf_health); 


/*    

// group list for layer selector -  ITEMS WILL APPEAR IN THE ORDER YOU PUT THEM IN BELOW:  
var boundaries_group = { 
                      "<span class='my-layer-item-basemap'>Basemap Labels</span>": l_labels_overlay,
                      "<span class='my-layer-item-steelblue'>Boroughs</span>": l_nybb,
                      "<span class='my-layer-item-steelblue'>Neighborhoods</span>": l_neighborhoods,
                      "<span class='my-layer-item-italic'>Neighborhood Labels</span>": l_neigh_labels, 
                      "<span class='my-layer-item-steelblue'>Community Districts</span>": l_nycd,
                      "<span class='my-layer-item-steelblue'>City Council</span>": l_nycc,
                      "<span class='my-layer-item-steelblue'>NY State Senate</span>": l_nyss,
                      "<span class='my-layer-item-steelblue'>NY State Assembly</span>": l_nyad,
                      "<span class='my-layer-item-steelblue'>US Congressional</span>": l_nycg,
                      "<span class='my-layer-item-steelblue'>Police Precincts</span>": l_precincts,
                      "<span class='my-layer-item-steelblue'>Zip Codes</span>": l_zipcode,
                      "<span class='my-layer-item-steelblue'>UHF Zones</span>": l_uhf_health
                    };
 
L.control.layers(null, boundaries_group, {collapsed: false, position:'topright', autoZIndex: false}).addTo(map_object);
//  L.control.layers(baseMaps, boundaries_group, {collapsed: false, position:'topright', autoZIndex: true}).addTo(map_object);
*/

// **********************************************************************************
// Leaflet Religious and CBO's overlays using cartodb.createLayer and .addTo() method

var cbo = cartodb.createLayer(map_object, {  // CBOs
                    user_name: 'ashron24',
                    type: 'cartodb',
                    sublayers: [{
                      sql: "SELECT cartodb_id, the_geom_webmercator, label FROM scrieloc2_1 ",
                      cartocss: "#layer [label='CBO'][zoom >= 10] {marker-width: 6; marker-file: url(https://s3.amazonaws.com/com.cartodb.users-assets.production/production/ashron24/assets/20150519173646protest.svg); marker-line-color: #FFFFFF; marker-placement: point; marker-type: ellipse;  marker-allow-overlap: true; }  #layer  [label='CBO'] [zoom >= 11] { marker-width: 9; } #layer [label='CBO'][zoom >= 12]{marker-width: 12; } #layer  [label='CBO'] [zoom >= 13]{   marker-width: 18; } #layer  [label='CBO'] [zoom >= 15]{ marker-width: 24; }",
                      interactivity: "cartodb_id"}]
                  });
    var l_cbo = new L.LayerGroup();
    cbo.addTo(l_cbo);

var health = cartodb.createLayer(map_object, {  //hospitals and clinics
                    user_name: 'ashron24',
                    type: 'cartodb',
                    sublayers: [{
                      sql: "SELECT cartodb_id, the_geom_webmercator, label FROM scrieloc2_1 ",
                      cartocss: "#layer [label='Health'][zoom >= 10] {marker-width: 6; marker-file: url('https://s3.amazonaws.com/com.cartodb.users-assets.production/production/ashron24/assets/20150707191228Hospital_Sign_Silhouette_32.png'); marker-line-color: #FFFFFF; marker-placement: point; marker-type: ellipse;  marker-allow-overlap: true; }  #layer  [label='Health'] [zoom >= 11] { marker-width: 9; } #layer [label='Health'][zoom >= 12]{marker-width: 12; } #layer  [label='Health'] [zoom >= 13]{   marker-width: 18; } #layer  [label='Health'] [zoom >= 15]{ marker-width: 24; }",
                      interactivity: "cartodb_id"}]
                  });
    var l_health = new L.LayerGroup();
    health.addTo(l_health);

var library = cartodb.createLayer(map_object, {  //libraries
                    user_name: 'ashron24',
                    type: 'cartodb',
                    sublayers: [{
                      sql: "SELECT cartodb_id, the_geom_webmercator, label FROM scrieloc2_1 ",
                      cartocss: "#layer [label='Library'][zoom >= 10] {marker-width: 6;marker-file: url(https://s3.amazonaws.com/com.cartodb.users-assets.production/production/ashron24/assets/20150707192220Open_book_32.png); marker-line-color: #FFFFFF; marker-placement: point; marker-type: ellipse;  marker-allow-overlap: true; }  #layer  [label='Library'] [zoom >= 11] { marker-width: 9; } #layer [label='Library'][zoom >= 12]{marker-width: 12; } #layer  [label='Library'] [zoom >= 13]{   marker-width: 18; } #layer  [label='Library'] [zoom >= 15]{ marker-width: 24; }",
                      interactivity: "cartodb_id"}]
                  });
    var l_library = new L.LayerGroup();
    library.addTo(l_library);

var fac = cartodb.createLayer(map_object, {  // facilities
                    user_name: 'ashron24',
                    type: 'cartodb',
                    sublayers: [{
                      sql: "SELECT cartodb_id, the_geom_webmercator, label FROM scrieloc2_1 ",
                      cartocss: "#layer [label='Fac'][zoom >= 10] {marker-width: 7; marker-file: url(https://s3.amazonaws.com/com.cartodb.users-assets.production/production/ashron24/assets/20150707192143Swimming_silhouette_32.png); marker-line-color: #FFFFFF; marker-placement: point; marker-type: ellipse;  marker-allow-overlap: true; }  #layer  [label='Fac'] [zoom >= 11] { marker-width: 10; } #layer [label='Fac'][zoom >= 12]{marker-width: 13; } #layer  [label='Fac'] [zoom >= 13]{   marker-width: 19; } #layer  [label='Fac'] [zoom >= 15]{ marker-width: 25; }",
                      interactivity: "cartodb_id"}]
                  });
    var l_fac = new L.LayerGroup();
    fac.addTo(l_fac);
    
var christian = cartodb.createLayer(map_object, 'https://nycdoitt.cartodb.com/u/asherross/api/v2/viz/f58781ea-570a-11e5-b973-0e4fddd5de28/viz.json'); 

/*  //old code - replaced above w/ secure data link
var christian = cartodb.createLayer(map_object, {  // religion type
                    user_name: 'ashron24',
                    type: 'cartodb',
                    sublayers: [{
                      sql: "SELECT cartodb_id, the_geom_webmercator, religion FROM haroldclergy3_11_15_merge ",
                      cartocss: "#layer [religion='Christian'] [zoom >= 10] { marker-file: url(https://s3.amazonaws.com/com.cartodb.users-assets.production/production/ashron24/assets/2015031200002750-px-red_cross.png);   marker-fill-opacity: 0.9;    marker-line-color: #FFF;  marker-line-width: 1;  marker-line-opacity: 1;    marker-placement: point;  marker-type: ellipse;  marker-width: 5;  marker-allow-overlap: true; }  #layer [religion='Christian'] [zoom >= 11] {    marker-width: 8; } #layer [religion='Christian'] [zoom >= 12] {    marker-width: 12; } #layer [religion='Christian'] [zoom >= 13] {    marker-width: 18; } #layer [religion='Christian'] [zoom >= 14] {marker-width: 24; } #layer [religion='Christian'] [zoom >= 15] { marker-width: 30; } ",
                      interactivity: "cartodb_id"}]
                  }); */

    var l_christian = new L.LayerGroup();
    christian.addTo(l_christian);

var jewish = cartodb.createLayer(map_object, {  // religion type
                    user_name: 'ashron24',
                    type: 'cartodb',
                    sublayers: [{
                      sql: "SELECT cartodb_id, the_geom_webmercator, religion FROM haroldclergy3_11_15_merge",
                      cartocss: "#layer [religion='Jewish'] [zoom >= 10]  { marker-file: url(https://s3.amazonaws.com/com.cartodb.users-assets.production/production/ashron24/assets/2015031200003950-px-Star_of_David.png);   marker-fill-opacity: 0.9;    marker-line-color: #FFF;    marker-line-width: 1;    marker-line-opacity: 1;    marker-placement: point;    marker-type: ellipse;    marker-width: 5;    marker-allow-overlap: true; }  #layer  [religion='Jewish'] [zoom >= 11] {    marker-width: 8; } #layer  [religion='Jewish'] [zoom >= 12] {    marker-width: 12; } #layer [zoom >= 13] [religion='Jewish'] {    marker-width: 18; } #layer [religion='Jewish'] [zoom >= 14]  {    marker-width: 24; } #layer  [religion='Jewish'] [zoom >= 15] {    marker-width: 30; } ",
                      interactivity: "cartodb_id"}]
                  });
    var l_jewish = new L.LayerGroup();
    jewish.addTo(l_jewish);

var muslim = cartodb.createLayer(map_object, {  // religion type
                    user_name: 'ashron24',
                    type: 'cartodb',
                    sublayers: [{
                      sql: "SELECT cartodb_id, the_geom_webmercator, religion FROM haroldclergy3_11_15_merge",
                      cartocss: "#layer [zoom >= 10][religion='Muslim'] { marker-file: url(https://s3.amazonaws.com/com.cartodb.users-assets.production/production/ashron24/assets/2015031200004950-px-muslim_crescent.png);   marker-fill-opacity: 0.9;    marker-line-color: #FFF;    marker-line-width: 5;    marker-line-opacity: 1;    marker-placement: point;    marker-type: ellipse;    marker-width: 5;    marker-allow-overlap: true; }   #haroldclergy3_11_15_merge [zoom >= 11][religion='Muslim'] {    marker-width: 8; } #haroldclergy3_11_15_merge [zoom >= 12][religion='Muslim'] {    marker-width: 12; } #haroldclergy3_11_15_merge [zoom >= 13][religion='Muslim'] {    marker-width: 18; } #haroldclergy3_11_15_merge [zoom >= 14][religion='Muslim'] {    marker-width: 24; } #haroldclergy3_11_15_merge [zoom >= 15][religion='Muslim'] {    marker-width: 30; } ",
                      interactivity: "cartodb_id"}]
                  });
    var l_muslim = new L.LayerGroup();
    muslim.addTo(l_muslim);

var buddhist = cartodb.createLayer(map_object, {  // religion type
                    user_name: 'ashron24',
                    type: 'cartodb',
                    sublayers: [{
                      sql: "SELECT cartodb_id, the_geom_webmercator, religion FROM haroldclergy3_11_15_merge",
                      cartocss: "#layer [zoom >=10][religion='Buddhist'] { marker-file: url(https://s3.amazonaws.com/com.cartodb.users-assets.production/production/ashron24/assets/2015031119270050-px-orange-dharma_wheel_2.png);   marker-fill-opacity: 0.9;    marker-line-color: #FFF;    marker-line-width: 1;    marker-line-opacity: 1;    marker-placement: point;    marker-type: ellipse;    marker-width: 5;    marker-allow-overlap: true; }  #haroldclergy3_11_15_merge [zoom >= 11][religion='Buddhist'] {    marker-width: 8; } #haroldclergy3_11_15_merge [zoom >= 12][religion='Buddhist'] {    marker-width: 12; } #haroldclergy3_11_15_merge [zoom >= 13][religion='Buddhist'] {    marker-width: 18; } #haroldclergy3_11_15_merge [zoom >= 14][religion='Buddhist'] {    marker-width: 24; } #haroldclergy3_11_15_merge [zoom >= 15][religion='Buddhist'] {    marker-width: 30; } ",
                      interactivity: "cartodb_id"}]
                  });
    var l_buddhist = new L.LayerGroup();
    buddhist.addTo(l_buddhist);

var hindu = cartodb.createLayer(map_object, {  // religion type
                    user_name: 'ashron24',
                    type: 'cartodb',
                    sublayers: [{
                      sql: "SELECT cartodb_id, the_geom_webmercator, religion FROM haroldclergy3_11_15_merge",
                      cartocss: "#layer [zoom >= 10][religion='Hindu'] { marker-file: url(https://s3.amazonaws.com/com.cartodb.users-assets.production/production/ashron24/assets/2015031119272950-pixel-Om.png);   marker-fill-opacity: 0.9;    marker-line-color: #FFF;    marker-line-width: 1;    marker-line-opacity: 1;    marker-placement: point;    marker-type: ellipse;    marker-width: 5;    marker-allow-overlap: true; }  #haroldclergy3_11_15_merge [zoom >= 11][religion='Hindu'] {    marker-width: 8; } #haroldclergy3_11_15_merge [zoom >= 12][religion='Hindu'] {    marker-width: 12; } #haroldclergy3_11_15_merge [zoom >= 13][religion='Hindu'] {    marker-width: 18; } #haroldclergy3_11_15_merge [zoom >= 14][religion='Hindu'] {    marker-width: 24; } #haroldclergy3_11_15_merge [zoom >= 15] [religion='Hindu'] {  marker-width: 30; } ",
                      interactivity: "cartodb_id"}]
                  });
    var l_hindu = new L.LayerGroup();
    hindu.addTo(l_hindu);

var sikh = cartodb.createLayer(map_object, {  // religion type
                    user_name: 'ashron24',
                    type: 'cartodb',
                    sublayers: [{
                      sql: "SELECT cartodb_id, the_geom_webmercator, religion FROM haroldclergy3_11_15_merge",
                      cartocss: "#layer [zoom >= 10][religion='Sikh'] { marker-file: url(https://s3.amazonaws.com/com.cartodb.users-assets.production/production/ashron24/assets/2015031119271550-px-yellow-Khanda.png);   marker-fill-opacity: 0.9;    marker-line-color: #FFF;    marker-line-width: 1;    marker-line-opacity: 1;    marker-placement: point;    marker-type: ellipse;    marker-width: 5;    marker-allow-overlap: true; }   #haroldclergy3_11_15_merge [zoom >= 11][religion='Sikh'] {    marker-width: 8; } #haroldclergy3_11_15_merge [zoom >= 12][religion='Sikh'] {    marker-width: 12; } #haroldclergy3_11_15_merge [zoom >= 13][religion='Sikh'] {    marker-width: 18; } #haroldclergy3_11_15_merge [zoom >= 14][religion='Sikh'] {    marker-width: 24; } #haroldclergy3_11_15_merge [zoom >= 15][religion='Sikh'] {    marker-width: 30; } ",
                      interactivity: "cartodb_id"}]
                  });
    var l_sikh = new L.LayerGroup();
    sikh.addTo(l_sikh);

var krishna = cartodb.createLayer(map_object, {  // religion type
                    user_name: 'ashron24',
                    type: 'cartodb',
                    sublayers: [{
                      sql: "SELECT cartodb_id, the_geom_webmercator, religion FROM haroldclergy3_11_15_merge",
                      cartocss: "#layer [zoom >= 10][religion='Hare Krishna'] { marker-file: url(https://s3.amazonaws.com/com.cartodb.users-assets.production/production/ashron24/assets/20150707172351lotus50px.png);   marker-fill-opacity: 0.9;    marker-line-color: #FFF;    marker-line-width: 1;    marker-line-opacity: 1;    marker-placement: point;    marker-type: ellipse;    marker-width: 5;    marker-allow-overlap: true; }  #haroldclergy3_11_15_merge  #haroldclergy3_11_15_merge [zoom >= 11][religion='Hare Krishna'] {    marker-width: 8; } #haroldclergy3_11_15_merge [zoom >= 12][religion='Hare Krishna'] {    marker-width: 12; } #haroldclergy3_11_15_merge [zoom >= 13][religion='Hare Krishna'] {    marker-width: 18; } #haroldclergy3_11_15_merge [zoom >= 14][religion='Hare Krishna'] {    marker-width: 24; } #haroldclergy3_11_15_merge [zoom >= 15][religion='Hare Krishna'] {    marker-width: 30; } ",
                      interactivity: "cartodb_id"}]
                  });
    var l_krishna = new L.LayerGroup();
    krishna.addTo(l_krishna);

var other_religion = cartodb.createLayer(map_object, {  // religion type
                    user_name: 'ashron24',
                    type: 'cartodb',
                    sublayers: [{
                      sql: "SELECT cartodb_id, the_geom_webmercator, religion FROM haroldclergy3_11_15_merge",
                      cartocss: "#layer [zoom >= 10][religion=''] { marker-file: url(https://s3.amazonaws.com/com.cartodb.users-assets.production/production/ashron24/assets/2015031200010650-px-domed_building.png);   marker-fill-opacity: 0.9;    marker-line-color: #FFF;    marker-line-width: 5;    marker-line-opacity: 1;    marker-placement: point;    marker-type: ellipse;    marker-width: 1;    marker-allow-overlap: true; }  #haroldclergy3_11_15_merge [zoom >= 11][religion=''] {    marker-width: 8; } #haroldclergy3_11_15_merge [zoom >= 12][religion=''] {    marker-width: 12; } #haroldclergy3_11_15_merge [zoom >= 13][religion=''] {    marker-width: 18; } #haroldclergy3_11_15_merge [zoom >= 14][religion=''] {    marker-width: 24; } #haroldclergy3_11_15_merge [zoom >= 15][religion=''] {    marker-width: 30; } ",
                      interactivity: "cartodb_id"}]
                  });
    var l_other_religion = new L.LayerGroup();
    other_religion.addTo(l_other_religion);

var nycha = cartodb.createLayer(map_object, {
            user_name: 'andrewmartini',
            type: 'cartodb',
            sublayers: [{
               sql: 'SELECT * FROM nycha_developments_july2011',
               cartocss: "#layer{    polygon-fill: #0700ff;    polygon-opacity: 0.9;    line-color: #FFF;    line-width: 0;    line-opacity: 0;  }    #nycha_developments_july2011::labels [zoom >= 12] [tot_pop11 > 4000] {    text-name: [developmen];    text-face-name: 'Lato Bold';    text-size: 10;    text-label-position-tolerance: 10;    text-fill: #11002F;    text-halo-fill: #FFF;    text-halo-radius: 1;    text-dy: 0;    text-wrap-width: 120;    text-wrap-before: true;    text-character-spacing: 1.5;    text-allow-overlap: false;    text-placement: point;    text-placement-type: simple;    }    #nycha_developments_july2011::labels [zoom >= 13] [tot_pop11 > 1000] {    text-name: [developmen];    text-face-name: 'DejaVu Sans Book';    text-size: 10;    text-label-position-tolerance: 10;    text-fill: #000;    text-halo-fill: #FFF;    text-halo-radius: 1;    text-dy: 0;    text-wrap-width: 150;    text-wrap-before: true;    text-character-spacing: 2;    text-allow-overlap: false;    text-placement: point;    text-placement-type: simple;    }    #nycha_developments_july2011::labels [zoom >= 14] [tot_pop11 > 500] {    text-name: [developmen];    text-face-name: 'DejaVu Sans Book';    text-size: 11;    text-label-position-tolerance: 10;    text-fill: #000;    text-halo-fill: #FFF;    text-halo-radius: 1;    text-dy: 0;    text-wrap-width: 160;    text-wrap-before: true;    text-character-spacing: 2;    text-allow-overlap: false;    text-placement: point;    text-placement-type: simple;    }    #nycha_developments_july2011::labels [zoom >= 15] [tot_pop11 > 100] {    text-name: [developmen];    text-face-name: 'DejaVu Sans Book';    text-size: 12;    text-label-position-tolerance: 10;    text-fill: #000;    text-halo-fill: #FFF;    text-halo-radius: 1;    text-dy: 0;    text-wrap-width: 200;    text-wrap-before: true;    text-character-spacing: 2;    text-allow-overlap: false;    text-placement: point;    text-placement-type: simple;    }    #nycha_developments_july2011::labels [zoom >= 15] [tot_pop11 > 100] {    text-name: [developmen];    text-face-name: 'DejaVu Sans Book';    text-size: 12;    text-label-position-tolerance: 10;    text-fill: #000;    text-halo-fill: #FFF;    text-halo-radius: 1;      }    #nycha_developments_july2011::labels [zoom >= 16] {    text-name: [developmen];    text-face-name: 'DejaVu Sans Book';    text-size: 12;    text-label-position-tolerance: 10;    text-fill: #000;    text-halo-fill: #FFF;    text-halo-radius: 1;    text-dy: 0;    text-wrap-width: 200;    text-wrap-before: true;    text-character-spacing: 2;    text-allow-overlap: false;    text-placement: point;    text-placement-type: simple;    } ",
               interactivity: 'cartodb_id'}]
          });
         var l_nycha = new L.LayerGroup();
         nycha.addTo(l_nycha);

  var subways = cartodb.createLayer(map_object, 'https://andrewmartini.cartodb.com/api/v2/viz/77a3e3a4-2aaf-11e5-8077-0e9d821ea90d/viz.json'); 
          var l_subways = new L.LayerGroup();
          subways.addTo(l_subways);

  var dpr_parks = cartodb.createLayer(map_object, 'https://andrewmartini.cartodb.com/api/v2/viz/14265a74-4129-11e5-a71a-0e4fddd5de28/viz.json'); 
          var l_dpr_parks = new L.LayerGroup();
          dpr_parks.addTo(l_dpr_parks); 



/*
              var clergy_cbo = {
                      "Community Based Orgs": l_cbo,
                      "Hospitals & Clinics": l_health,
                      "Libraries": l_library,
                      "Senior & Rec Centers": l_fac,
                      "<span class='my-layer-item-red'>Christian Orgs</span>": l_christian,
                      "<span class='my-layer-item-blue'>Jewish Orgs</span>": l_jewish,
                      "<span class='my-layer-item-green'>Muslim Orgs</span>": l_muslim,
                      "<span class='my-layer-item-salmon'>Hindu Orgs</span>": l_hindu,
                      "<span class='my-layer-item-orange'>Buddhist Orgs</span>": l_buddhist,
                      "<span class='my-layer-item-yellow'>Sikh Orgs</span>": l_sikh,
                      "<span class='my-layer-item-purple'>Hare Krishna Orgs</span>": l_krishna, 
                      "Other Religious Orgs": l_other_religion,
                      "NYCHA developments": l_nycha,
                      "Subway Lines": l_subways,
                      "Parks Properties": l_dpr_parks               
                };

                L.control.layers(null, clergy_cbo, {collapsed: false, position:'topright', autoZIndex:false}).addTo(map_object);
*/


//******************************************************
// GROUP 3 CAU OUTREACH TARGETS 


  var rentreg = cartodb.createLayer(map_object, 'https://nycdoitt.cartodb.com/u/asherross/api/v2/viz/7d9bcc4e-573d-11e5-be93-0e9d821ea90d/viz.json'); 
          var l_rentreg = new L.LayerGroup();
          rentreg.addTo(l_rentreg);

  var nails = cartodb.createLayer(map_object, 'https://ashron24.cartodb.com/api/v2/viz/9cd21ef2-2bfe-11e5-9adf-0e4fddd5de28/viz.json'); 
          var l_nails = new L.LayerGroup();
          nails.addTo(l_nails);


  var vision_zero = cartodb.createLayer(map_object, 'https://ashron24.cartodb.com/api/v2/viz/5f2fe1a8-2f12-11e5-8b7e-0e0c41326911/viz.json'); 
          var l_vision_zero = new L.LayerGroup();
          vision_zero.addTo(l_vision_zero);

  var id_ny = cartodb.createLayer(map_object, 'https://nycdoitt.cartodb.com/u/asherross/api/v2/viz/acfe8376-573f-11e5-9d39-0e018d66dc29/viz.json'); 
          var l_id_ny = new L.LayerGroup();
          id_ny.addTo(l_id_ny);

var scrie = cartodb.createLayer(map_object, 'https://ashron24.cartodb.com/api/v2/viz/765c7704-2bfe-11e5-99c0-0e018d66dc29/viz.json'); 
          var l_scrie = new L.LayerGroup();
          scrie.addTo(l_scrie);
          
var cau_events = cartodb.createLayer(map_object, 'https://ashron2224.cartodb.com/api/v2/viz/8bcbcfa4-354a-11e5-9b8e-0e4fddd5de28/viz.json'); 
          var l_cau_events = new L.LayerGroup();
          cau_events.addTo(l_cau_events);

var paid_sick = cartodb.createLayer(map_object, 'https://ashron24.cartodb.com/api/v2/viz/b985e2b8-1911-11e5-bd0e-0e853d047bba/viz.json'); 
          var l_paid_sick = new L.LayerGroup();
          paid_sick.addTo(l_paid_sick);

/*

    var cau_outreach_targets = {
        "CAU events by Neigh": l_cau_events,
        "SCRIE Outreach": l_scrie,
        "SCRIE private test": l_scrie_private,
        "Rent Regulated Target": l_rentreg,
        "ID NY Target Locations": l_id_ny,
        "Paid Sick Leave": l_paid_sick,
        "Nail Salon // Action": l_nails,
        "Vision Zero": l_vision_zero
        
    };

     L.control.layers(null, cau_outreach_targets, {collapsed: false, position:'topright', autoZIndex: false}).addTo(map_object);

*/

//******************************************************
// GROUP 4 DEMOGRAPHICS & OTHER

var lang_plurality = cartodb.createLayer(map_object, {
            user_name: 'andrewmartini',
            type: 'cartodb',
            sublayers: [{
               sql: 'select * from schlang_merge_05_04',
               cartocss:  "#schlang_merge_05_04 {    polygon-opacity: 0.8;    line-color: #FFF;    line-width: 1;    line-opacity: 0.5; }  #schlang_merge_05_04[_plura_grp='French Creoles'] {    polygon-fill: #A53ED5; } #schlang_merge_05_04[_plura_grp='Indo-European: Balto-Slavic'] {    polygon-fill: #0000a0; } #schlang_merge_05_04[_plura_grp='Indo-European: Romance'] {    polygon-fill: #5CA2D1; } #schlang_merge_05_04[_plura_grp='Indo-European: Germanic'] {    polygon-fill: #cccccc; } #schlang_merge_05_04[_plura_grp='Indo-European: Other'] {    polygon-fill: #00ceff;   } #schlang_merge_05_04[_plura_grp='Uralic'] {    polygon-fill: #00ceff; }  #schlang_merge_05_04[_plura_grp='Sino-Tibetan: Chinese'] {    polygon-fill: #ff0000; } #schlang_merge_05_04[_plura_grp='South Asian'] {    polygon-fill: #ffa500; } #schlang_merge_05_04[_plura_grp='E & SE Asia: other'] {    polygon-fill: #fb9a99; } #schlang_merge_05_04[_plura_grp='Austronesian: Malayo-Polynesian'] {    polygon-fill: #fb9a99; }  #schlang_merge_05_04[_plura_grp='Afro-Asiatic: Semitic'] {    polygon-fill: #49db40; } #schlang_merge_05_04[_plura_grp='Niger-Congo: Atlantic-Congo'] {    polygon-fill: #136400; } #schlang_merge_05_04[_plura_grp='Niger-Congo: Mande'] {    polygon-fill: #229A00; }  #schlang_merge_05_04 {    polygon-fill: #DDDDDD; }     /** language labels for _plura */ #schlang_merge_05_04::labels [zoom >= 12] {   text-name: [_plura];   text-face-name: 'Lato Bold';   text-size: 10;   text-wrap-before: true;   text-wrap-width: 20;   text-label-position-tolerance: 10;   text-fill: #000;   text-halo-fill: #FFF;   text-halo-radius: 1;   text-dy: 0;   text-allow-overlap: false;   text-placement: point;   text-placement-type: simple; }  #schlang_merge_05_04::labels [zoom >= 13]  {   text-name: [_plura]+' '+[_plura_qt];   text-face-name: 'Lato Bold';   text-size: 11; }  #schlang_merge_05_04::labels [zoom >= 14] {   text-name: [_plura]+' '+[_plura_qt];   text-face-name: 'Lato Bold';   text-size: 13; }",
               interactivity: 'cartodb_id'}]
          });
         var l_lang_plurality = new L.LayerGroup();
         lang_plurality.addTo(l_lang_plurality);

 var plur_non_eng = cartodb.createLayer(map_object, {
            user_name: 'andrewmartini',
            type: 'cartodb',
            sublayers: [{
               sql: 'select * from schlang_merge_05_04',
               cartocss: "#layer {     polygon-opacity: 0.8;     line-color: #FFF;     line-width: 0.5;     line-opacity: 1;  }   #layer[_plurne_grp='French Creoles'] {     polygon-fill: #A53ED5;  }  #layer[_plurne_grp='Indo-European: Balto-Slavic']  {     polygon-fill: #0000a0;  }  #layer[_plurne_grp='Indo-European: Romance']  {     polygon-fill: #5CA2D1;  }  #layer[_plurne_grp='Indo-European: Germanic']  {     polygon-fill: #cccccc;  }  #layer[_plurne_grp='Indo-European: Other']  {      polygon-fill: #00ceff;    }  #layer[_plurne_grp='Uralic']  {     polygon-fill: #00ceff;  }   #layer[_plurne_grp='Sino-Tibetan: Chinese']  {     polygon-fill: #ff0000;  }  #layer[_plurne_grp='South Asian']  {     polygon-fill: #ffa500;  }  #layer[_plurne_grp='E & SE Asia: other'] {     polygon-fill: #fb9a99;  }  #layer[_plurne_grp='Austronesian: Malayo-Polynesian']  {     polygon-fill: #fb9a99;  }   #layer[_plurne_grp='Afro-Asiatic: Semitic']  {     polygon-fill: #49db40;  }  #layer[_plurne_grp='Niger-Congo: Atlantic-Congo'] {     polygon-fill: #136400;  }  #layer[_plurne_grp='Niger-Congo: Mande'] {     polygon-fill: #229A00;  }   #layer {     polygon-fill: #DDDDDD;  }      /** language labels for _plurne */  #layer::labels [zoom >= 12] {    text-name: [_plurne];    text-face-name: 'Lato Bold';    text-size: 10;    text-wrap-before: true;    text-wrap-width: 20;    text-label-position-tolerance: 10;    text-fill: #000;    text-halo-fill: #FFF;    text-halo-radius: 1;    text-dy: 0;    text-allow-overlap: false;    text-placement: point;    text-placement-type: simple;  }   #layer::labels [zoom >= 13] {    text-name: [_plurne]+' '+[_plurne_qty];    text-face-name: 'Lato Bold';    text-size: 11;  }   #layer::labels [zoom >= 14] {    text-name: [_plurne]+' '+[_plurne_qty];    text-face-name: 'Lato Bold';    text-size: 13;  }  #schlang_poly_v3_1::labels [_plurne_qty <= 9]{    text-name: [_plurne];    text-face-name: 'Lato Bold';    text-size: 0;    text-fill: #fff;    text-halo-radius: 0;  }  ",
               interactivity: 'cartodb_id'}]
          });
         var l_plur_non_eng = new L.LayerGroup();
         plur_non_eng.addTo(l_plur_non_eng);         

  var nonengspan = cartodb.createLayer(map_object, {
            user_name: 'andrewmartini',
            type: 'cartodb',
            sublayers: [{
               sql: 'select * from schlang_merge_05_04',
               cartocss: "#layer {  polygon-opacity: 0.8;  line-color: #FFF;  line-width: 0.5;  line-opacity: 1;  }   /** language group polygon fill */  #schlang_merge_05_04[_plurnes_gr='Sino-Tibetan: Chinese'] {  polygon-fill: #ff0000;  }  #schlang_merge_05_04[_plurnes_gr='South Asian'] {  polygon-fill: #ffa500;  }  #schlang_merge_05_04[_plurnes_gr='E & SE Asia: other'] {  polygon-fill: #fb9a99;  }  #schlang_merge_05_04[_plurnes_gr='Austronesian: Malayo-Polynesian'] {  polygon-fill: #fb9a99;  } #schlang_merge_05_04[_plurnes_gr='Afro-Asiatic: Semitic'] {  polygon-fill: #49db40;  }  #schlang_merge_05_04[_plurnes_gr='Niger-Congo: Atlantic-Congo'] {  polygon-fill: #136400;  }  #schlang_merge_05_04[_plurnes_gr='Niger-Congo: Mande'] {  polygon-fill: #229A00;  }   #schlang_merge_05_04[_plurnes_gr='French Creoles'] {  polygon-fill: #A53ED5;  }  #schlang_merge_05_04[_plurnes_gr='Indo-European: Balto-Slavic'] {  polygon-fill: #0000a0;  }  #schlang_merge_05_04[_plurnes_gr='Indo-European: Romance'] {  polygon-fill: #5CA2D1;  }  #schlang_merge_05_04[_plurnes_gr='Indo-European: Germanic'] {  polygon-fill: #5CA2D1;  }  #schlang_merge_05_04[_plurnes_gr='Indo-European: Other'] {  polygon-fill: #00ceff;   }  #schlang_merge_05_04[_plurnes_gr='Uralic'] {  polygon-fill: #00ceff;  }   #schlang_merge_05_04 {  polygon-fill: #DDDDDD;  }   /** language labels for plurnes */  #schlang_merge_05_04::labels [zoom >= 12] { text-name: [_plurnes]; text-face-name: 'Lato Bold'; text-size: 10; text-wrap-before: true; text-wrap-width: 20;  text-transform: capitalize; text-label-position-tolerance: 10; text-fill: #000; text-halo-fill: #FFF; text-halo-radius: 1; text-dy: 0; text-allow-overlap: false; text-placement: point; text-placement-type: simple;  }   #schlang_merge_05_04::labels [zoom >= 13]      { text-name: [_plurnes]+' '+[_plurnes_qt]; text-face-name: 'Lato Bold'; text-size: 11;  }   #schlang_merge_05_04::labels [zoom >= 14]  { text-name: [_plurnes]+' '+[_plurnes_qt]; text-face-name: 'Lato Bold'; text-size: 13;  } #schlang_poly_v3_1::labels [_plurnes_qt < 9]{   text-name: [_plurnes_qt];   text-face-name: 'Lato Bold';   text-size: 0;   text-fill: #fff;   text-halo-radius: 0; }",
               interactivity: 'cartodb_id'}]
          });
         var l_nonengspan = new L.LayerGroup();
         nonengspan.addTo(l_nonengspan);

var none = cartodb.createLayer(map_object, {    // dummy placeholder for "none" value
                      user_name: 'andrewmartini',
                      type: 'cartodb',
                      sublayers: [{
                        sql: "SELECT cartodb_id, the_geom_webmercator FROM nybb",
                        cartocss: "#layer{   polygon-fill: #fff;   polygon-opacity: 0;   line-color: #FFF;   line-width: 0;   line-opacity: 0; }",
                      interactivity: "cartodb_id"}]
                    });
    var l_none = new L.LayerGroup();
    none.addTo(l_none); 

var percent_nhblack_choro = cartodb.createLayer(map_object, {   
                      user_name: 'andrewmartini',
                      type: 'cartodb',
                      sublayers: [{
                        sql: "SELECT cartodb_id, the_geom_webmercator, (nhblack/totalpop)*100 as percent_black FROM tracttemp where totalpop > 100",
                        cartocss: "#tracttemp{   polygon-fill: #ffffb2;   polygon-opacity: 0.8;   line-color: #FFF;   line-width: 0.1;   line-opacity: 1; } #tracttemp [ percent_black <= 100] {    polygon-fill: #B10026; } #tracttemp [ percent_black <= 90] {    polygon-fill: #E31A1C; } #tracttemp [ percent_black <= 65] {    polygon-fill: #FC4E2A; } #tracttemp [ percent_black <= 50] {    polygon-fill: #FD8D3C; } #tracttemp [ percent_black <= 35] {    polygon-fill: #FEB24C; } #tracttemp [ percent_black <= 20] {    polygon-fill: #FED976; } #tracttemp [ percent_black <= 10] {    polygon-fill: #FFFFB2; }",
                      interactivity: "cartodb_id"}]
                    });
    var l_percent_nhblack_choro = new L.LayerGroup();
    percent_nhblack_choro.addTo(l_percent_nhblack_choro); 
    

var percent_nhwhite_choro = cartodb.createLayer(map_object, {   
                      user_name: 'andrewmartini',
                      type: 'cartodb',
                      sublayers: [{
                        sql: "SELECT cartodb_id, the_geom_webmercator, (nhwhite/totalpop)*100 as percent_white FROM tracttemp where totalpop > 100",
                        cartocss: "#tracttemp{   polygon-fill: #ffffb2;   polygon-opacity: 0.8;   line-color: #FFF;   line-width: 0.1;   line-opacity: 1; } #tracttemp [ percent_white <= 100] {    polygon-fill: #B10026; } #tracttemp [ percent_white <= 90] {    polygon-fill: #E31A1C; } #tracttemp [ percent_white <= 65] {    polygon-fill: #FC4E2A; } #tracttemp [ percent_white <= 50] {    polygon-fill: #FD8D3C; } #tracttemp [ percent_white <= 35] {    polygon-fill: #FEB24C; } #tracttemp [ percent_white <= 20] {    polygon-fill: #FED976; } #tracttemp [ percent_white <= 10] {    polygon-fill: #FFFFB2; }",
                      interactivity: "cartodb_id"}]
                    });
    var l_percent_nhwhite_choro = new L.LayerGroup();
    percent_nhwhite_choro.addTo(l_percent_nhwhite_choro); 

var percent_foreignborn_choro = cartodb.createLayer(map_object, {   
                      user_name: 'andrewmartini',
                      type: 'cartodb',
                      sublayers: [{
                        sql: "SELECT cartodb_id, the_geom_webmercator, (foreignbor/totalpop)*100 AS percent_fb FROM tracttemp where totalpop > 100",
                        cartocss: "#tracttemp{   polygon-fill: #ffffb2;   polygon-opacity: 0.8;   line-color: #FFF;   line-width: 0.1;   line-opacity: 1; } #tracttemp [ percent_fb <= 100] {    polygon-fill: #B10026; } #tracttemp [ percent_fb <= 90] {    polygon-fill: #E31A1C; } #tracttemp [ percent_fb <= 65] {    polygon-fill: #FC4E2A; } #tracttemp [ percent_fb <= 50] {    polygon-fill: #FD8D3C; } #tracttemp [ percent_fb <= 35] {    polygon-fill: #FEB24C; } #tracttemp [ percent_fb <= 20] {    polygon-fill: #FED976; } #tracttemp [ percent_fb <= 10] {    polygon-fill: #FFFFB2; }",
                      interactivity: "cartodb_id"}]
                    });
    var l_percent_foreignborn_choro = new L.LayerGroup();
    percent_foreignborn_choro.addTo(l_percent_foreignborn_choro); 

var percent_nhasian_choro = cartodb.createLayer(map_object, {   
                      user_name: 'andrewmartini',
                      type: 'cartodb',
                      sublayers: [{
                        sql: "SELECT cartodb_id, the_geom_webmercator, (nhasian/totalpop)*100 as percent_asian FROM tracttemp where totalpop > 100",
                        cartocss: "#tracttemp{   polygon-fill: #ffffb2;   polygon-opacity: 0.8;   line-color: #FFF;   line-width: 0.1;   line-opacity: 1; } #tracttemp [ percent_asian <= 100] {    polygon-fill: #B10026; } #tracttemp [ percent_asian <= 90] {    polygon-fill: #E31A1C; } #tracttemp [ percent_asian <= 65] {    polygon-fill: #FC4E2A; } #tracttemp [ percent_asian <= 50] {    polygon-fill: #FD8D3C; } #tracttemp [ percent_asian <= 35] {    polygon-fill: #FEB24C; } #tracttemp [ percent_asian <= 20] {    polygon-fill: #FED976; } #tracttemp [ percent_asian <= 10] {    polygon-fill: #FFFFB2; }",
                      interactivity: "cartodb_id"}]
                    });
    var l_percent_nhasian_choro = new L.LayerGroup();
    percent_nhasian_choro.addTo(l_percent_nhasian_choro); 

var percent_hispanic_choro = cartodb.createLayer(map_object, {   
                      user_name: 'andrewmartini',
                      type: 'cartodb',
                      sublayers: [{
                        sql: "SELECT cartodb_id, the_geom_webmercator, (hispanic/totalpop)*100 as percent_hispanic FROM tracttemp where totalpop > 100",
                        cartocss: "#tracttemp{   polygon-fill: #ffffb2;   polygon-opacity: 0.8;   line-color: #FFF;   line-width: 0.1;   line-opacity: 1; } #tracttemp [ percent_hispanic <= 100] {    polygon-fill: #B10026; } #tracttemp [ percent_hispanic <= 90] {    polygon-fill: #E31A1C; } #tracttemp [ percent_hispanic <= 65] {    polygon-fill: #FC4E2A; } #tracttemp [ percent_hispanic <= 50] {    polygon-fill: #FD8D3C; } #tracttemp [ percent_hispanic <= 35] {    polygon-fill: #FEB24C; } #tracttemp [ percent_hispanic <= 20] {    polygon-fill: #FED976; } #tracttemp [ percent_hispanic <= 10] {    polygon-fill: #FFFFB2; }",
                      interactivity: "cartodb_id"}]
                    });
    var l_percent_hispanic_choro = new L.LayerGroup();
    percent_hispanic_choro.addTo(l_percent_hispanic_choro); 

var median_inc_to_rent = cartodb.createLayer(map_object, {   
                      user_name: 'andrewmartini',
                      type: 'cartodb',
                      sublayers: [{
                        sql: "SELECT * FROM tracttemp WHERE Totalpop > 250",
                        cartocss: "#tracttemp{   polygon-fill: #EDF8FB;   polygon-opacity: 0.8;   line-color: #FFF;   line-width: 0.1;   line-opacity: 1; } #tracttemp [ medrenttoh <= 50] {    polygon-fill: #d73027; } #tracttemp [ medrenttoh <= 44.65] {    polygon-fill: #fc8d59; } #tracttemp [ medrenttoh <= 40.15] {    polygon-fill: #fee08b; } #tracttemp [ medrenttoh <= 35.65] {    polygon-fill: #ffffbf; } #tracttemp [ medrenttoh <= 31.15] {    polygon-fill: #d9ef8b; } #tracttemp [ medrenttoh <= 26.65] {    polygon-fill: #91cf60; } #tracttemp [ medrenttoh <= 22.15] {    polygon-fill: #1a9850; }",
                      interactivity: "cartodb_id"}]
                    });
    var l_median_inc_to_rent = new L.LayerGroup();
    median_inc_to_rent.addTo(l_median_inc_to_rent); 

var median_inc_choro = cartodb.createLayer(map_object, {   
                      user_name: 'andrewmartini',
                      type: 'cartodb',
                      sublayers: [{
                        sql: "SELECT cartodb_id, the_geom_webmercator, medianhhin FROM tracttemp WHERE Totalpop > 250",
                        cartocss: "#tracttemp{   polygon-fill: #d73027;   polygon-opacity: 0.8;   line-color: #FFF;   line-width: 0.1;   line-opacity: 1; } #tracttemp [ medianhhin <= 243622] {    polygon-fill: #1a9850; } #tracttemp [ medianhhin <= 84240] {    polygon-fill: #8cce8a; } #tracttemp [ medianhhin <= 67394] {    polygon-fill: #d2ecb4; } #tracttemp [ medianhhin <= 57176] {    polygon-fill: #fff2cc; } #tracttemp [ medianhhin <= 48159] {    polygon-fill: #fed6b0; } #tracttemp [ medianhhin <= 39538] {    polygon-fill: #f79272; } #tracttemp [ medianhhin <= 30106] {    polygon-fill: #d73027; }",
                      interactivity: "cartodb_id"}]
                    });
    var l_median_inc_choro  = new L.LayerGroup();
    median_inc_choro.addTo(l_median_inc_choro); 

var bangladesh_gradu = cartodb.createLayer(map_object, {   
                      user_name: 'andrewmartini',
                      type: 'cartodb',
                      sublayers: [{
                        sql: "SELECT the_geom, the_geom_webmercator, cartodb_id, bangladesh FROM tracttemp WHERE bangladesh > 5",
                        cartocss:  "#layer {   marker-fill-opacity: 0.8;   marker-line-color: #FFBE34;   marker-line-width: 1.5;   marker-line-opacity: 1;   marker-placement: point;   marker-multi-policy: largest;   marker-type: ellipse;   marker-fill: #FFBE34;   marker-allow-overlap: true;   marker-clip: false; } #layer [ bangladesh <= 1600] {    marker-width: 32.0; } #layer [ bangladesh <= 1000] {    marker-width: 24.0; } #layer [ bangladesh <= 500] {    marker-width: 18; } #layer [ bangladesh <= 100] {    marker-width: 12; } #layer [ bangladesh <= 50] {    marker-width: 8; } #layer [ bangladesh <= 10] {   marker-width: 2.0; } ",
                      interactivity: "cartodb_id"}]
                    });
    var l_bangladesh_gradu  = new L.LayerGroup();
    bangladesh_gradu.addTo(l_bangladesh_gradu); 

var pakistani_gradu = cartodb.createLayer(map_object, {   
                      user_name: 'andrewmartini',
                      type: 'cartodb',
                      sublayers: [{
                        sql: "SELECT the_geom, the_geom_webmercator, cartodb_id, pakistani FROM tracttemp WHERE pakistani > 5",
                        cartocss: " #tracttemp{   marker-fill-opacity: 0.8;   marker-line-color: #B8905F;   marker-line-width: 1.5;   marker-line-opacity: 1;   marker-placement: point;   marker-multi-policy: largest;   marker-type: ellipse;   marker-fill: #B8905F;   marker-allow-overlap: true;   marker-clip: false; } #tracttemp [ pakistani <= 1600] {    marker-width: 32.0; } #tracttemp [ pakistani <= 1000] {    marker-width: 24.0; } #tracttemp [ pakistani <= 500] {    marker-width: 18; } #tracttemp [ pakistani <= 100] {    marker-width: 12; } #tracttemp [ pakistani <= 50] {    marker-width: 8; } #tracttemp [ pakistani <= 10] {    marker-width: 2.0; }",
                      interactivity: "cartodb_id"}]
                    });
    var l_pakistani_gradu  = new L.LayerGroup();
    pakistani_gradu.addTo(l_pakistani_gradu); 

var arab_gradu = cartodb.createLayer(map_object, {   
                      user_name: 'andrewmartini',
                      type: 'cartodb',
                      sublayers: [{
                        sql: "SELECT the_geom, the_geom_webmercator, cartodb_id, arab FROM tracttemp WHERE arab > 5",
                        cartocss: "#tracttemp{   marker-fill-opacity: 0.8;   marker-line-color: #6EBC88;   marker-line-width: 1.5;   marker-line-opacity: 1;   marker-placement: point;   marker-multi-policy: largest;   marker-type: ellipse;   marker-fill: #6EBC88;   marker-allow-overlap: true;   marker-clip: false; } #tracttemp [ arab <= 1600] {    marker-width: 32.0; } #tracttemp [ arab <= 1000] {    marker-width: 24.0; } #tracttemp [ arab <= 500] {    marker-width: 18; } #tracttemp [ arab <= 100] {    marker-width: 12; } #tracttemp [ arab <= 50] {    marker-width: 8; } #tracttemp [ arab <= 10] {    marker-width: 2.0; }",
                      interactivity: "cartodb_id"}]
                    });
    var l_arab_gradu = new L.LayerGroup();
    arab_gradu.addTo(l_arab_gradu); 

map_object.addLayer(l_neigh_labels);

/*
 var demographic = {

        "Percent Hispanic": l_percent_hispanic_choro,
        "Percent NH White": l_percent_nhwhite_choro,
        "Percent NH Black": l_percent_nhblack_choro,       
        "Percent NH Asian": l_percent_nhasian_choro,
        "Median HH Income": l_median_inc_choro,
        "Median Inc to Rent": l_median_inc_to_rent,
        "DOE: Lang Plurality": l_lang_plurality,
        "DOE: Non-Engl Plur": l_plur_non_eng,
        "DOE: Non-Engl/Span": l_nonengspan,        
        "Prcnt Foreign Born": l_percent_foreignborn_choro,
        "Bangladeshi": l_bangladesh_gradu,
        "Pakistani": l_pakistani_gradu,
        "Arab": l_arab_gradu
    };
  L.control.layers(null, demographic, {collapsed: false, position:'topright', autoZIndex: false}).addTo(map_object);
*/




    var baseLayers = {
            "<span class='my-layer-item-basemap'>Gray Basemap</span>": light_nolabels,
            "<span class='my-layer-item-basemap'>Streets</span>": OpenStreetMap_Mapnik,
            "<span class='my-layer-item-basemap'>Satellite Basemap</span>": Esri_WorldImagery,
            "<span class='my-layer-item-basemap'>Shaded Relief</span>": Stamen_TerrainBackground,
            "<span class='my-layer-item-basemap'>Black Wallpaper</span>": black_wallpaper
          };




    // Overlay layers are grouped
    var groupedOverlays = {
      "Districts": {
                      "<span class='my-layer-item-steelblue'>Boroughs</span>": l_nybb,
                      "<span class='my-layer-item-steelblue'>Neighborhoods</span>": l_neighborhoods,
                      "<span class='my-layer-item-steelblue'>Community Districts</span>": l_nycd,
                      "<span class='my-layer-item-steelblue'>City Council</span>": l_nycc,
                      "<span class='my-layer-item-steelblue'>NY State Senate</span>": l_nyss,
                      "<span class='my-layer-item-steelblue'>NY State Assembly</span>": l_nyad,
                      "<span class='my-layer-item-steelblue'>US Congressional</span>": l_nycg,
                      "<span class='my-layer-item-steelblue'>Police Precincts</span>": l_precincts,
                      "<span class='my-layer-item-steelblue'>Zip Codes</span>": l_zipcode,
                      "<span class='my-layer-item-steelblue'>UHF Zones</span>": l_uhf_health
      },
      "Labels": {
                    "Cartodb Basemap Labels": l_labels_overlay,   
                    "CAU's Neighborhood Labels": l_neigh_labels
      },
      "Facilities": {
                      "Community Based Orgs": l_cbo,
                      "Hospitals & Clinics": l_health,
                      "Libraries": l_library,
                      "Senior & Rec Centers": l_fac,
                      "NYCHA developments": l_nycha,
                      "Subway Lines": l_subways,
                      "Parks Properties": l_dpr_parks 
      },
      "Religious Organizations" :{
                      "<img src='nyc-map-app/images/red_cross-50px.png' alt='icon' height='12px' width='12px' /> <span class='my-layer-item-red'>Christian Orgs</span>": l_christian,
                      "<span class='my-layer-item-blue'>Jewish Orgs</span>": l_jewish,
                      "<span class='my-layer-item-green'>Muslim Orgs</span>": l_muslim,
                      "<span class='my-layer-item-salmon'>Hindu Orgs</span>": l_hindu,
                      "<span class='my-layer-item-orange'>Buddhist Orgs</span>": l_buddhist,
                      "<span class='my-layer-item-yellow'>Sikh Orgs</span>": l_sikh,
                      "<span class='my-layer-item-purple'>Hare Krishna Orgs</span>": l_krishna, 
                      "Other Religious Orgs": l_other_religion
      },
      "CAU Outreach Targets": {
                    "CAU events by Neigh": l_cau_events,
                    "SCRIE Outreach": l_scrie,
                    "Rent Regulated Target": l_rentreg,
                    "ID NY Target Locations": l_id_ny,
                    "Paid Sick Leave": l_paid_sick,
                    "Nail Salon // Action": l_nails,
                    "Vision Zero": l_vision_zero
      },
      "Demographics": {
                  "None": l_none,
                  "Percent Hispanic": l_percent_hispanic_choro,
                  "Percent NH White": l_percent_nhwhite_choro,
                  "Percent NH Black": l_percent_nhblack_choro,       
                  "Percent NH Asian": l_percent_nhasian_choro
      },
      "Income": {
                  "Median HH Income": l_median_inc_choro,
                  "Median Inc to Rent": l_median_inc_to_rent
      },
      "DOE Language Data": {
                  "DOE: Lang Plurality": l_lang_plurality,
                  "DOE: Non-Engl Plur": l_plur_non_eng,
                  "DOE: Non-Engl/Span": l_nonengspan
      },
      "Foreign Born": {     
                  "Prcnt Foreign Born": l_percent_foreignborn_choro,
                  "Bangladeshi": l_bangladesh_gradu,
                  "Pakistani": l_pakistani_gradu,
                  "Arab": l_arab_gradu
      }      
    };

    // Make the "Demographics" group exclusive (use radio inputs)
    var options = { exclusiveGroups: ["Demographics"], groupCheckboxes: true, collapsed: false, autoZIndex: false };

    // Use the custom grouped layer control, not "L.control.layers"
    var layerControl = L.control.groupedLayers(baseLayers, groupedOverlays, options);
    map_object.addControl(layerControl);



// legend generator code: 
var nhblacklegend = L.control({position: 'bottomright'});
nhblacklegend.onAdd = function (map_object) {
    var div = L.DomUtil.create('div', 'info legend'),
        grades = [0, 10, 20, 35, 50, 65, 90],
        labels = [];

    // loop through our density intervals and generate a label with a colored square for each interval
    // first loop for colored legend boxes
    for (var i = 0; i < grades.length; i++) {
        div.innerHTML +=
            '<span style="background:' + getColor(grades[i] + 1) + '"></span> ';
    }

    // a line break
    div.innerHTML += '<br>';

    // second loop for text
    for (var i = 0; i < grades.length; i++) {
        div.innerHTML +=
            '<label>' + grades[i] + (grades[i + 1] ? '&ndash;' + grades[i + 1] : '+') + '</label>';
    }
    return div;
};

var nhwhitelegend = L.control({position: 'bottomright'});
nhwhitelegend.onAdd = function (map) {
    var div = L.DomUtil.create('div', 'info legend'),
        grades = [0, 10, 20, 35, 50, 65, 90],
        labels = [];

    // loop through our density intervals and generate a label with a colored square for each interval
    // first loop for colored legend boxes
    for (var i = 0; i < grades.length; i++) {
        div.innerHTML +=
            '<span style="background:' + getColor(grades[i] + 1) + '"></span> ';
    }

    // a line break
    div.innerHTML += '<br>';

    // second loop for text
    for (var i = 0; i < grades.length; i++) {
        div.innerHTML +=
            '<label>' + grades[i] + (grades[i + 1] ? '&ndash;' + grades[i + 1] : '+') + '</label>';
    }
    return div;
};


//legend.addTo(map_object);



//nhwhitelegend.addTo(map_object);
// currentLegend = nhwhitelegend;

// http://leafletjs.com/reference.html#control-layers-overlayadd

map_object.on('overlayadd', function (eventLayer) {
    if (eventLayer.name === 'l_percent_nhblack_choro') {
        map_object.removeControl(currentLegend );
        currentLegend = nhblacklegend;
        nhblacklegend.addTo(map_object);
    }
    else if  (eventLayer.name === 'l_percent_nhwhite_choro') {
        map_object.removeControl(currentLegend );
        currentLegend = nhwhitelegend;
        nhwhitelegend.addTo(map_object);
    }
 
  })

    // adds a simple scalebar
   // L.control.scale().addTo(map_object);

            }
        </script>
    </body>
</html>
